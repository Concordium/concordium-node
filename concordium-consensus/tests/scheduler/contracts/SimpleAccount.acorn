module SimpleAccount where

import Prod
import Maybe
import Prim
import Unit
import Blockchain
import Helpers

def pair :: Unit.Unit -> Prim.Transaction -> Prod.Pair Unit.Unit Prim.Transaction
def pair = Prod.Pair [Unit.Unit, Prim.Transaction]

contract Account where

  init (ia :: Unit.Unit) (c :: Prim.InitContext) (amount :: Amount) =
    ia

  receive (c :: Prim.ReceiveContext) (model :: Unit.Unit) (caller :: Blockchain.Caller) (amount :: Amount) (msg :: Maybe.Maybe Unit.Unit) =
    case msg of
      Maybe.Nothing ->
        let ret :: Unit.Unit -> Maybe.Maybe (Prod.Pair Unit.Unit Prim.Transaction) = Helpers.accept [Unit.Unit] in
        ret Unit.Unit
      Maybe.Just (_ :: Unit.Unit) -> Helpers.reject [Unit.Unit]
